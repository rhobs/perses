"use strict";(self.chunk_StatusHistoryChart=self.chunk_StatusHistoryChart||[]).push([["543"],{68485:function(e,t,a){a.r(t),a.d(t,{StatusHistoryChart:()=>j});var i=a(62540),n=a(57744),r=a(38662),s=a(37266),l=a(7013),o=a(74628),d=a(40224),h=a(70451),u=a(64886);let p="#1f77b4";var m=a(99415),c=a(56599),g=a(88091),f=a(9356),y=a(46182),x=a(59738),v=a(90652),M=a(72106),S=a(55875),C=a(74653),b=a(37573),w=a(69402);(0,C.Y)([f.a,y.a,x.a,v.a,M.a,S.a,b.a]);let A=e=>{var t;let{height:a,data:n,xAxisCategories:r,yAxisCategories:l,timeScale:d,colors:h}=e,{timeZone:u}=(0,s.useTimeZone)(),p=(0,s.useChartsTheme)(),m=(0,c.A)(),f=p.noDataOption.title.textStyle,y={tooltip:{appendToBody:!0,formatter:e=>(function(e){let{data:t,label:a,marker:i,xAxisCategories:n,yAxisCategories:r,theme:l}=e,[o,d]=t,h=n[o],{formattedDate:u,formattedTime:p}=(0,s.getDateAndTime)(h),m=(0,w.css)`
    border-bottom: 1px solid ${l.palette.grey[500]};
    padding-bottom: 8px;
  `,c=(0,w.css)`
    display: flex;
    justify-content: space-between;
    padding-top: 8px;
  `,g=(0,w.css)`
    margin-right: 16px;
  `;return`
    <div>
      <div style="${m.styles}">${u} ${p}</div>
      <div style="${c.styles}">
        <div style="${g.styles}">
          ${i}
          <strong>${r[d]}</strong>
        </div>
        <div>
          ${a}
        </div>
      </div>
    </div>
  `})({data:e.data.value,label:e.data.label,marker:e.marker,xAxisCategories:r,yAxisCategories:l,theme:m})},grid:{top:"5%",bottom:"5%"},xAxis:{type:"category",data:r,axisLine:{show:!1},splitArea:{show:!1},axisLabel:{hideOverlap:!0,formatter:(t=(null==d?void 0:d.rangeMs)??0,function(e){let a=new Date(Number(e));return t>15768e7?(0,s.formatWithTimeZone)(a,"yyy",u):t>63072e6?(0,s.formatWithTimeZone)(a,"MMM yyy",u):t>864e6&&t<1577664e4?(0,s.formatWithTimeZone)(a,"dd.MM",u):t>1728e5&&t<=864e6?(0,s.formatWithTimeZone)(a,"dd.MM HH:mm",u):(0,s.formatWithTimeZone)(a,"HH:mm",u)})}},yAxis:{type:"category",data:l,axisLine:{show:!1},splitArea:{show:!1,interval:0},splitLine:{show:!1},axisLabel:{interval:0}},visualMap:{show:!1,type:"piecewise",pieces:h},series:[{name:"Status history",type:"heatmap",coordinateSystem:"cartesian2d",data:n,label:{show:!1},itemStyle:{borderWidth:1,borderType:"solid",borderColor:"#ffffff"},emphasis:{itemStyle:{opacity:.5}}}]};return(0,i.jsx)(o.A,{style:{height:a},sx:{overflow:"auto",display:"flex",justifyContent:"center",alignItems:"center"},children:n.length?(0,i.jsx)(s.EChart,{style:{width:"100%",height:a},option:y,theme:p.echartsTheme}):(0,i.jsx)(g.A,{sx:{...f},children:"No data"})})},j={PanelComponent:function(e){var t;let{spec:a,contentDimensions:r,queryResults:l}=e,c=(0,h.useMemo)(()=>a.legend&&(0,n.validateLegendSpec)(a.legend)?(0,d.merge)({},a.legend):void 0,[a.legend]),g=(0,s.useChartsTheme)(),f=g.container.padding.default,{statusHistoryData:y,yAxisCategories:x,xAxisCategories:v,legendItems:M,timeScale:S,colors:C}=(t=g.echartsTheme.color,(0,h.useMemo)(()=>{var e;let i;if(!l||0===l.length)return{legendItems:[],statusHistoryData:[],xAxisCategories:[],yAxisCategories:[],colors:[]};let n=(i=l.map(e=>e.data),(0,m.l$)(i)),r=[],s=[],o=new Set,d=null==(e=a.mappings)?void 0:e.length,h=function(e){if(!e)return[];let{startMs:t,endMs:a,stepMs:i}=e,n=[];for(let e=t;e<=a;e+=i)n.push(e);return n}(n);l.forEach(e=>{let{data:t}=e;t&&t.series.forEach(e=>{let t=e.formattedName||"";s.push(t);let i=s.length-1;e.values.forEach(e=>{let[t,n]=e,s=h.findIndex(e=>e===t);if(null!==n&&-1!==s){let e=n;d&&(e=(0,u.u)(n,a.mappings).value),o.add(n),r.push({value:[s,i,n],label:String(e)})}})})});let c=Array.from(o),g=t.length>=c.length?t.slice(0,c.length):c.map((e,a)=>a<t.length?t[a]||p:function(e,t){t.match(/^#[0-9A-Fa-f]{6}$/)||(t=p);try{var a,i,n;let r,s,[l,o,d]=function(e){let t=parseInt(e.slice(1,3),16)/255,a=parseInt(e.slice(3,5),16)/255,i=parseInt(e.slice(5,7),16)/255,n=Math.max(t,a,i),r=Math.min(t,a,i),s=0,l=0,o=(n+r)/2;if(n!==r){let e=n-r;switch(l=o>.5?e/(2-n-r):e/(n+r),n){case t:s=(a-i)/e+6*(a<i);break;case a:s=(i-t)/e+2;break;case i:s=(t-a)/e+4}s/=6}return[360*s,100*l,100*o]}(t);if(isNaN(l)||isNaN(o)||isNaN(d))throw Error("Invalid HSL values");let h=String(e).split("").reduce((e,t)=>e+t.charCodeAt(0),0),u=Math.min(o+10,90),p=(a=Math.abs((l+h%6*60)%360),i=Math.min(Math.max(u,50),90),n=Math.min(Math.max(d+(h%2?15:-15),30),70),r=i*Math.min(n/=100,1-n)/100,s=e=>{let t=(e+a/30)%12;return Math.round(255*(n-r*Math.max(Math.min(t-3,9-t,1),-1))).toString(16).padStart(2,"0")},`#${s(0)}${s(8)}${s(4)}`);if(!p.match(/^#[0-9A-Fa-f]{6}$/))throw Error("Invalid generated color");return p}catch{return p}}(e,t[0]||p)),f=c.map((e,t)=>{let i=g[t]??p;return d&&(i=(0,u.u)(e,a.mappings).color??i),{value:e,color:i}});return{xAxisCategories:h,yAxisCategories:s,legendItems:c.map((e,t)=>{var i;let n=String(e);d&&(n=String((0,u.u)(e,a.mappings).value));let r=(null==(i=f.find(t=>t.value===e))?void 0:i.color)||p;return{id:`${t}-${e}`,label:n,color:r}}),statusHistoryData:r,timeScale:n,colors:f}},[l,a.mappings,t])),b=r?{width:r.width-2*f,height:r.height-2*f}:void 0;return(0,i.jsx)(o.A,{sx:{padding:`${f}px`},children:(0,i.jsx)(s.ContentWithLegend,{width:(null==b?void 0:b.width)??400,height:(null==b?void 0:b.height)??1e3,legendSize:null==c?void 0:c.size,legendProps:c&&{options:c,data:M||[],selectedItems:"ALL",onSelectedItemsChange:()=>null},children:e=>{let{height:t,width:a}=e;return(0,i.jsx)(o.A,{sx:{height:t,width:a},children:(0,i.jsx)(A,{xAxisCategories:v,yAxisCategories:x,data:y??[],timeScale:S,height:t,colors:C})})}})})},supportedQueryTypes:["TimeSeriesQuery"],panelOptionsEditorComponents:[{label:"Settings",content:function(e){let{onChange:t,value:a}=e;return(0,i.jsxs)(s.OptionsEditorGrid,{children:[(0,i.jsx)(s.OptionsEditorColumn,{children:(0,i.jsx)(n.LegendOptionsEditor,{calculation:"aggregation",showValuesEditor:!1,value:a.legend,onChange:e=>{t((0,r.jM)(a,t=>{t.legend=e}))}})}),(0,i.jsx)(s.OptionsEditorColumn,{children:(0,i.jsx)(s.OptionsEditorGroup,{title:"Reset Settings",children:(0,i.jsx)(l.A,{variant:"outlined",color:"secondary",onClick:()=>{t((0,r.jM)(a,e=>{e.legend=void 0}))},children:"Reset To Defaults"})})})]})}},{label:"Value mapping",content:e=>{let{onChange:t,value:a}=e;return(0,i.jsx)(s.ValueMappingsEditor,{mappings:a.mappings??[],onChange:function(e){t({...a,mappings:e})}})}}],createInitialOptions:function(){return{}}}}}]);