{"version":3,"sources":["../../../../src/TracingGanttChart/GanttTable/SpanDuration.tsx"],"sourcesContent":["// Copyright 2024 The Perses Authors\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Box, useTheme } from '@mui/material';\nimport { useChartsTheme } from '@perses-dev/components';\nimport { ReactElement } from 'react';\nimport { Viewport, formatDuration, getSpanColor, minSpanWidthPx } from '../utils';\nimport { Ticks } from '../Ticks';\nimport { TracingGanttChartOptions } from '../../gantt-chart-model';\nimport { Span } from '../trace';\n\nexport interface SpanDurationProps {\n  options: TracingGanttChartOptions;\n  span: Span;\n  viewport: Viewport;\n}\n\n/**\n * SpanDuration renders the right column of a SpanRow, i.e. the span bar and span duration\n */\nexport function SpanDuration(props: SpanDurationProps): ReactElement {\n  const { options, span, viewport } = props;\n  const muiTheme = useTheme();\n  const chartsTheme = useChartsTheme();\n\n  const spanDuration = span.endTimeUnixMs - span.startTimeUnixMs;\n  const viewportDuration = viewport.endTimeUnixMs - viewport.startTimeUnixMs;\n  const relativeDuration = spanDuration / viewportDuration;\n  const relativeStart = (span.startTimeUnixMs - viewport.startTimeUnixMs) / viewportDuration;\n\n  return (\n    <Box sx={{ position: 'relative', height: '100%', flexGrow: 1, overflow: 'hidden' }}>\n      <Ticks />\n      <Box\n        data-testid=\"span-duration-bar\"\n        sx={{\n          position: 'absolute',\n          top: 0,\n          bottom: 0,\n          margin: 'auto',\n          minWidth: `${minSpanWidthPx}px`,\n          height: '8px',\n          borderRadius: muiTheme.shape.borderRadius,\n        }}\n        style={{\n          left: `${relativeStart * 100}%`,\n          width: `${relativeDuration * 100}%`,\n          backgroundColor: getSpanColor(muiTheme, chartsTheme, options.visual?.palette?.mode, span),\n        }}\n      />\n      <Box\n        sx={{\n          position: 'absolute',\n          top: '50%',\n          transform: 'translateY(-50%)',\n          padding: '0 8px',\n          color: muiTheme.palette.grey[700],\n          fontSize: '.7rem',\n        }}\n        style={\n          /* print span duration on right side of the span bar, if there is space */\n          relativeStart + relativeDuration < 0.95\n            ? {\n                left: `${(relativeStart + relativeDuration) * 100}%`,\n              }\n            : {\n                left: `${relativeStart * 100}%`,\n                transform: 'translateY(-50%) translateX(-100%)',\n              }\n        }\n      >\n        {formatDuration(spanDuration)}\n      </Box>\n    </Box>\n  );\n}\n"],"names":["Box","useTheme","useChartsTheme","formatDuration","getSpanColor","minSpanWidthPx","Ticks","SpanDuration","props","options","span","viewport","muiTheme","chartsTheme","spanDuration","endTimeUnixMs","startTimeUnixMs","viewportDuration","relativeDuration","relativeStart","sx","position","height","flexGrow","overflow","data-testid","top","bottom","margin","minWidth","borderRadius","shape","style","left","width","backgroundColor","visual","palette","mode","transform","padding","color","grey","fontSize"],"mappings":";AAAA,oCAAoC;AACpC,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,6CAA6C;AAC7C,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AAEjC,SAASA,GAAG,EAAEC,QAAQ,QAAQ,gBAAgB;AAC9C,SAASC,cAAc,QAAQ,yBAAyB;AAExD,SAAmBC,cAAc,EAAEC,YAAY,EAAEC,cAAc,QAAQ,WAAW;AAClF,SAASC,KAAK,QAAQ,WAAW;AAUjC;;CAEC,GACD,OAAO,SAASC,aAAaC,KAAwB;IACnD,MAAM,EAAEC,OAAO,EAAEC,IAAI,EAAEC,QAAQ,EAAE,GAAGH;IACpC,MAAMI,WAAWX;IACjB,MAAMY,cAAcX;IAEpB,MAAMY,eAAeJ,KAAKK,aAAa,GAAGL,KAAKM,eAAe;IAC9D,MAAMC,mBAAmBN,SAASI,aAAa,GAAGJ,SAASK,eAAe;IAC1E,MAAME,mBAAmBJ,eAAeG;IACxC,MAAME,gBAAgB,AAACT,CAAAA,KAAKM,eAAe,GAAGL,SAASK,eAAe,AAAD,IAAKC;IAE1E,qBACE,MAACjB;QAAIoB,IAAI;YAAEC,UAAU;YAAYC,QAAQ;YAAQC,UAAU;YAAGC,UAAU;QAAS;;0BAC/E,KAAClB;0BACD,KAACN;gBACCyB,eAAY;gBACZL,IAAI;oBACFC,UAAU;oBACVK,KAAK;oBACLC,QAAQ;oBACRC,QAAQ;oBACRC,UAAU,GAAGxB,eAAe,EAAE,CAAC;oBAC/BiB,QAAQ;oBACRQ,cAAclB,SAASmB,KAAK,CAACD,YAAY;gBAC3C;gBACAE,OAAO;oBACLC,MAAM,GAAGd,gBAAgB,IAAI,CAAC,CAAC;oBAC/Be,OAAO,GAAGhB,mBAAmB,IAAI,CAAC,CAAC;oBACnCiB,iBAAiB/B,aAAaQ,UAAUC,aAAaJ,QAAQ2B,MAAM,EAAEC,SAASC,MAAM5B;gBACtF;;0BAEF,KAACV;gBACCoB,IAAI;oBACFC,UAAU;oBACVK,KAAK;oBACLa,WAAW;oBACXC,SAAS;oBACTC,OAAO7B,SAASyB,OAAO,CAACK,IAAI,CAAC,IAAI;oBACjCC,UAAU;gBACZ;gBACAX,OACE,wEAAwE,GACxEb,gBAAgBD,mBAAmB,OAC/B;oBACEe,MAAM,GAAG,AAACd,CAAAA,gBAAgBD,gBAAe,IAAK,IAAI,CAAC,CAAC;gBACtD,IACA;oBACEe,MAAM,GAAGd,gBAAgB,IAAI,CAAC,CAAC;oBAC/BoB,WAAW;gBACb;0BAGLpC,eAAeW;;;;AAIxB"}