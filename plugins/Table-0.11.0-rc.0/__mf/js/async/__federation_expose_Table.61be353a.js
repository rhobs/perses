"use strict";(self.chunk_Table=self.chunk_Table||[]).push([["2669"],{4073:function(e,t,n){n.r(t),n.d(t,{Table:()=>G});var l=n(70451),i=n.n(l),o=n(93648),r=n(315),a=n(97653),s=n(88091);function d(e,t){for(let l of t)if(function(e,t){var n,l,i,o,r,a,s;switch(e.kind){case"Value":return(null==(n=e.spec)?void 0:n.value)===String(t);case"Range":{if(Number.isNaN(Number(t)))return!1;let n=Number(t);if((null==(l=e.spec)?void 0:l.min)!==void 0&&(null==(i=e.spec)?void 0:i.max)!==void 0)return n>=+e.spec.min&&n<=+e.spec.max;if((null==(o=e.spec)?void 0:o.min)!==void 0)return n>=+e.spec.min;if((null==(r=e.spec)?void 0:r.max)!==void 0)return n<=+e.spec.max;return!1}case"Regex":if(!(null==(a=e.spec)?void 0:a.expr))return!1;try{return new RegExp(e.spec.expr).test(String(t))}catch{return!1}case"Misc":switch(null==(s=e.spec)?void 0:s.value){case"empty":return""===t;case"null":return null==t;case"NaN":return Number.isNaN(t);case"true":return!0===t;case"false":return!1===t;default:return!1}default:return!1}}(l.condition,e)){let t;if("Misc"===l.condition.kind){var n;switch(null==(n=l.condition.spec)?void 0:n.value){case"null":t="null";break;case"NaN":t="NaN"}}return function(e,t,n){let l=t.text||n||String(e);return{text:`${t.prefix??""}${l}${t.suffix??""}`,textColor:t.textColor,backgroundColor:t.backgroundColor}}(e,l,t)}}var c=n(62540),u=n(54381),h=n(47095),p=n(65211),g=n(6227),x=n(7013),m=n(86067),f=n(86742),v=n(37266);function j(e){let{cell:t,onChange:n,onDelete:l,...d}=e;return(0,c.jsxs)(u.A,{container:!0,spacing:2,...d,children:[(0,c.jsx)(u.A,{size:{xs:5},children:(0,c.jsxs)(r.A,{direction:"row",gap:1,width:"100%",children:[(0,c.jsxs)(o.A,{select:!0,label:"Type",value:t.condition.kind,onChange:e=>n({...t,condition:{kind:e.target.value}}),required:!0,sx:{width:"120px"},children:[(0,c.jsx)(a.A,{value:"Value",children:(0,c.jsxs)(r.A,{children:[(0,c.jsx)(s.A,{children:"Value"}),"Value"!==t.condition.kind&&(0,c.jsx)(s.A,{variant:"caption",children:"Matches an exact text value"})]})}),(0,c.jsx)(a.A,{value:"Range",children:(0,c.jsxs)(r.A,{children:[(0,c.jsx)(s.A,{children:"Range"}),"Range"!==t.condition.kind&&(0,c.jsx)(s.A,{variant:"caption",children:"Matches against a numerical range"})]})}),(0,c.jsx)(a.A,{value:"Regex",children:(0,c.jsxs)(r.A,{children:[(0,c.jsx)(s.A,{children:"Regex"}),"Regex"!==t.condition.kind&&(0,c.jsx)(s.A,{variant:"caption",children:"Matches against a regular expression"})]})}),(0,c.jsx)(a.A,{value:"Misc",children:(0,c.jsxs)(r.A,{children:[(0,c.jsx)(s.A,{children:"Misc"}),"Misc"!==t.condition.kind&&(0,c.jsx)(s.A,{variant:"caption",children:"Matches against empty, null and NaN values"})]})})]}),function(e,t){var n,l,d,c,u;let h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"small";return"Value"===e.kind?i().createElement(o.A,{label:"Value",placeholder:"Exact value",value:(null==(n=e.spec)?void 0:n.value)??"",onChange:n=>t({...e,spec:{value:n.target.value}}),fullWidth:!0,size:h}):"Range"===e.kind?i().createElement(r.A,{gap:1,direction:"row"},[i().createElement(o.A,{key:"min",label:"From",placeholder:"Start of range",value:(null==(l=e.spec)?void 0:l.min)??"",onChange:n=>t({...e,spec:{...e.spec,min:+n.target.value}}),fullWidth:!0,size:h}),i().createElement(o.A,{key:"max",label:"To",placeholder:"End of range (inclusive)",value:(null==(d=e.spec)?void 0:d.max)??"",onChange:n=>t({...e,spec:{...e.spec,max:+n.target.value}}),fullWidth:!0,size:h})]):"Regex"===e.kind?i().createElement(o.A,{label:"Regular Expression",placeholder:"JavaScript regular expression",value:(null==(c=e.spec)?void 0:c.expr)??"",onChange:n=>t({...e,spec:{expr:n.target.value}}),fullWidth:!0,size:h}):"Misc"===e.kind?i().createElement(o.A,{select:!0,label:"Value",value:(null==(u=e.spec)?void 0:u.value)??"",onChange:n=>t({...e,spec:{value:n.target.value}}),fullWidth:!0,size:h},[{value:"empty",label:"Empty",caption:"Matches empty string"},{value:"null",label:"Null",caption:"Matches null or undefined"},{value:"NaN",label:"NaN",caption:"Matches Not a Number value"},{value:"true",label:"True",caption:"Matches true boolean"},{value:"false",label:"False",caption:"Matches false boolean"}].map(e=>i().createElement(a.A,{key:e.value,value:e.value},i().createElement(r.A,{key:"stack"},[i().createElement(s.A,{key:"title"},e.label),i().createElement(s.A,{key:"caption",variant:"caption"},e.caption)])))):null}(t.condition,e=>n({...t,condition:e}),"small")]})}),(0,c.jsx)(u.A,{size:{xs:4},children:(0,c.jsxs)(r.A,{spacing:1,children:[(0,c.jsx)(o.A,{label:"Display text",value:t.text,onChange:e=>n({...t,text:e.target.value}),fullWidth:!0,size:"small"}),(0,c.jsxs)(r.A,{direction:"row",spacing:1,children:[(0,c.jsx)(o.A,{label:"Prefix",placeholder:"$",value:t.prefix??"",onChange:e=>n({...t,prefix:e.target.value}),size:"small"}),(0,c.jsx)(o.A,{label:"Suffix",placeholder:"%",value:t.suffix??"",onChange:e=>n({...t,suffix:e.target.value}),size:"small"})]})]})}),(0,c.jsx)(u.A,{size:{xs:1},children:(0,c.jsx)(r.A,{direction:"row",justifyContent:"center",gap:1,children:t.textColor?(0,c.jsx)(v.OptionsColorPicker,{label:"Text Color",color:t.textColor??"#000",onColorChange:e=>n({...t,textColor:e}),onClear:()=>n({...t,textColor:void 0})}):(0,c.jsx)(h.A,{onClick:()=>n({...t,textColor:"#000"}),children:(0,c.jsx)(f.default,{})})})}),(0,c.jsx)(u.A,{size:{xs:1},children:(0,c.jsx)(r.A,{direction:"row",justifyContent:"center",children:t.backgroundColor?(0,c.jsx)(v.OptionsColorPicker,{label:"Background Color",color:t.backgroundColor??"#fff",onColorChange:e=>n({...t,backgroundColor:e}),onClear:()=>n({...t,backgroundColor:void 0})}):(0,c.jsx)(h.A,{onClick:()=>n({...t,backgroundColor:"#000"}),children:(0,c.jsx)(f.default,{})})})}),(0,c.jsx)(u.A,{size:{xs:1},textAlign:"end",children:(0,c.jsx)(p.A,{title:"Remove cell settings",placement:"top",children:(0,c.jsx)(h.A,{size:"small",sx:{marginLeft:"auto"},onClick:l,children:(0,c.jsx)(m.default,{})},"delete-cell-button")})})]})}function C(e){let{cellSettings:t=[],onChange:n,addButtonText:l="Add Conditional Format"}=e;return(0,c.jsxs)(r.A,{spacing:3,sx:{mt:2},children:[(0,c.jsxs)(u.A,{container:!0,spacing:3,children:[(0,c.jsx)(u.A,{size:{xs:5},children:(0,c.jsx)(s.A,{variant:"subtitle1",children:"Condition"})}),(0,c.jsx)(u.A,{size:{xs:4},children:(0,c.jsx)(s.A,{variant:"subtitle1",children:"Display Text"})}),(0,c.jsx)(u.A,{size:{xs:1},textAlign:"center",children:(0,c.jsx)(s.A,{variant:"subtitle1",children:"Color"})}),(0,c.jsx)(u.A,{size:{xs:1},textAlign:"center",children:(0,c.jsx)(s.A,{variant:"subtitle1",children:"Background"})}),(0,c.jsx)(u.A,{size:{xs:1}})]}),(0,c.jsx)(r.A,{gap:1.5,divider:(0,c.jsx)(g.A,{flexItem:!0,orientation:"horizontal"}),children:t.map((e,l)=>(0,c.jsx)(j,{cell:e,onChange:e=>{let i;(i=[...t])[l]=e,n(i)},onDelete:()=>{let e;(e=[...t]).splice(l,1),n(e.length>0?e:void 0)}},l))}),(0,c.jsx)(x.A,{variant:"outlined",startIcon:(0,c.jsx)(f.default,{}),sx:{marginTop:1},onClick:()=>{let e=[...t];e.push({condition:{kind:"Value",spec:{value:""}}}),n(e)},children:l})]})}function b(e){let{cellSettings:t,onChange:n}=e;return(0,c.jsx)(C,{cellSettings:t,onChange:e=>n(e||[])})}var A=n(68003),k=n(12138),y=n(57744),S=n(42524);let E=e=>{let{onChange:t,column:n,column:{dataLink:l}}=e;if(!l)return(0,c.jsxs)(r.A,{sx:{width:"100%",alignItems:"center"},direction:"row",children:[(0,c.jsx)(s.A,{flex:1,variant:"subtitle1",mb:2,fontStyle:"italic",children:"No link defined"}),(0,c.jsx)(h.A,{style:{width:"fit-content",height:"fit-content"},onClick:()=>t({...n,dataLink:{url:"",openNewTab:!0,title:""}}),children:(0,c.jsx)(f.default,{})})]});let{url:i,openNewTab:o,title:a}=l;return(0,c.jsxs)(r.A,{sx:{width:"100%",alignItems:"center"},direction:"row",children:[(0,c.jsx)(v.LinkEditorForm,{mode:"inline",url:{label:"Url",onChange:e=>{t({...n,dataLink:{...l,url:e}})},value:i,placeholder:"URL",error:{hasError:!1,helperText:""}},name:{label:"Name",onChange:e=>{t({...n,dataLink:{...l,title:e}})},value:a??"",placeholder:"Name"},newTabOpen:{label:"Open in new tab",onChange:e=>{t({...n,dataLink:{...l,openNewTab:e}})},value:o}}),(0,c.jsx)(h.A,{style:{width:"fit-content",height:"fit-content"},onClick:()=>{t({...n,dataLink:void 0})},children:(0,c.jsx)(S.default,{})})]})},w={unit:"decimal",shortValues:!0};function O(e){let{column:t,onChange:n,...i}=e,[a,s]=(0,l.useState)(void 0===t.width||"auto"===t.width?100:t.width);return(0,c.jsxs)(r.A,{...i,children:[(0,c.jsxs)(v.OptionsEditorGrid,{children:[(0,c.jsx)(v.OptionsEditorColumn,{children:(0,c.jsxs)(v.OptionsEditorGroup,{title:"Column",children:[(0,c.jsx)(v.OptionsEditorControl,{label:"Name*",control:(0,c.jsx)(o.A,{value:t.name,onChange:e=>n({...t,name:e.target.value}),required:!0})}),(0,c.jsx)(v.OptionsEditorControl,{label:"Header",control:(0,c.jsx)(o.A,{value:t.header??"",onChange:e=>n({...t,header:e.target.value?e.target.value:void 0})})}),(0,c.jsx)(v.OptionsEditorControl,{label:"Header Tooltip",control:(0,c.jsx)(o.A,{value:t.headerDescription??"",onChange:e=>n({...t,headerDescription:e.target.value?e.target.value:void 0})})}),(0,c.jsx)(v.OptionsEditorControl,{label:"Cell Tooltip",control:(0,c.jsx)(o.A,{value:t.cellDescription??"",onChange:e=>n({...t,cellDescription:e.target.value?e.target.value:void 0})})}),(0,c.jsx)(v.OptionsEditorControl,{label:"Enable sorting",control:(0,c.jsx)(A.A,{checked:t.enableSorting??!1,onChange:e=>n({...t,enableSorting:e.target.checked})})}),t.enableSorting&&(0,c.jsx)(v.OptionsEditorControl,{label:"Default Sort",control:(0,c.jsx)(v.SortSelectorButtons,{size:"medium",value:t.sort,sx:{margin:.5},onChange:e=>n({...t,sort:e})})})]})}),(0,c.jsx)(v.OptionsEditorColumn,{children:(0,c.jsxs)(v.OptionsEditorGroup,{title:"Visual",children:[(0,c.jsx)(v.OptionsEditorControl,{label:"Show column",control:(0,c.jsx)(A.A,{checked:!t.hide,onChange:e=>n({...t,hide:!e.target.checked})})}),(0,c.jsx)(v.OptionsEditorControl,{label:"Display",control:(0,c.jsxs)(k.A,{"aria-label":"Display",size:"small",children:[(0,c.jsx)(x.A,{variant:t.plugin?"outlined":"contained",onClick:()=>n({...t,plugin:void 0}),children:"Text"}),(0,c.jsx)(x.A,{variant:t.plugin?"contained":"outlined",onClick:()=>n({...t,plugin:{kind:"StatChart",spec:{}}}),children:"Embedded Panel"})]})}),t.plugin?(0,c.jsx)(v.OptionsEditorControl,{label:"Panel Type",control:(0,c.jsx)(y.PluginKindSelect,{pluginTypes:["Panel"],value:{type:"Panel",kind:t.plugin.kind},onChange:e=>n({...t,plugin:{kind:e.kind,spec:{}}})})}):(0,c.jsx)(v.FormatControls,{value:t.format??w,onChange:e=>n({...t,format:e})}),(0,c.jsx)(v.OptionsEditorControl,{label:"Alignment",control:(0,c.jsx)(v.AlignSelector,{size:"small",value:t.align??"left",onChange:e=>n({...t,align:e})})}),(0,c.jsx)(v.OptionsEditorControl,{label:"Custom width",control:(0,c.jsx)(A.A,{checked:void 0!==t.width&&"auto"!==t.width,onChange:e=>n({...t,width:e.target.checked?a:"auto"})})}),void 0!==t.width&&"auto"!==t.width&&(0,c.jsx)(v.OptionsEditorControl,{label:"Width",control:(0,c.jsx)(o.A,{type:"number",value:a,slotProps:{htmlInput:{min:1}},onChange:e=>{s(+e.target.value),n({...t,width:+e.target.value})}})})]})}),(0,c.jsx)(v.OptionsEditorColumn,{children:(0,c.jsx)(v.OptionsEditorGroup,{title:"Link",children:(0,c.jsx)(E,{column:t,onChange:n})})})]}),(0,c.jsx)(r.A,{sx:{px:8},children:(0,c.jsx)(v.OptionsEditorGroup,{title:"Conditional Cell Format",children:(0,c.jsx)(C,{cellSettings:t.cellSettings,onChange:e=>n({...t,cellSettings:e})})})})]})}var M=n(11061),T=n(87275),z=n(1355),D=n(78536);function N(e){let{column:t,isCollapsed:n,onChange:l,onCollapse:i,onDelete:o,onMoveUp:a,onMoveDown:d}=e;return(0,c.jsxs)(v.DragAndDropElement,{data:t,children:[(0,c.jsxs)(r.A,{direction:"row",alignItems:"center",borderBottom:1,borderColor:e=>e.palette.divider,justifyContent:"space-between",gap:4,children:[(0,c.jsxs)(r.A,{direction:"row",gap:1,children:[(0,c.jsx)(h.A,{"data-testid":`column-toggle#${t.name}`,size:"small",onClick:()=>i(!n),children:n?(0,c.jsx)(M.default,{}):(0,c.jsx)(T.default,{})}),(0,c.jsxs)(s.A,{variant:"overline",component:"h4",sx:{textTransform:"none"},children:["COLUMN:"," ",t.header?(0,c.jsxs)("span",{children:[(0,c.jsx)("strong",{children:t.header})," (",t.name,")"]}):(0,c.jsx)("strong",{children:t.name})]})]}),(0,c.jsxs)(r.A,{direction:"row",gap:1,children:[n&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(p.A,{title:t.hide?"Show column":"Hide column",placement:"top",children:(0,c.jsx)(h.A,{size:"small",sx:{marginLeft:"auto"},onClick:function(){l({...t,hide:!t.hide})},children:t.hide?(0,c.jsx)(D.default,{}):(0,c.jsx)(z.default,{})},"hide-column")}),(0,c.jsx)(g.A,{flexItem:!0,orientation:"vertical",variant:"middle"})]}),(0,c.jsx)(p.A,{title:"Remove column settings",placement:"top",children:(0,c.jsx)(h.A,{size:"small",sx:{marginLeft:"auto"},onClick:o,children:(0,c.jsx)(m.default,{})},"delete-column-button")}),(0,c.jsx)(p.A,{title:"Reorder column settings",placement:"top",children:(0,c.jsx)(v.DragButton,{onMoveUp:a,onMoveDown:d,menuSx:{".MuiPaper-root":{backgroundColor:e=>e.palette.background.lighter}}},"reorder-column-button")})]})]}),!n&&(0,c.jsx)("div",{children:(0,c.jsx)(O,{column:t,onChange:l})})]})}function R(e){let{columnSettings:t,onChange:n}=e,[i,o]=(0,l.useState)(t.map(()=>!0));return(0,v.useDragAndDropMonitor)({elements:t,accessKey:"name",onChange:n}),(0,c.jsxs)(r.A,{spacing:1,children:[t.map((e,l)=>(0,c.jsx)(N,{column:e,isCollapsed:i[l]??!0,onChange:e=>{let i;(i=[...t])[l]=e,n(i)},onDelete:()=>{let e;(e=[...t]).splice(l,1),n(e),o(e=>(e.splice(l,1),[...e]))},onCollapse:e=>{o(t=>(t[l]=e,[...t]))},onMoveUp:()=>n((0,v.handleMoveUp)(e,t)),onMoveDown:()=>n((0,v.handleMoveDown)(e,t))},l)),(0,c.jsx)(x.A,{variant:"contained",startIcon:(0,c.jsx)(f.default,{}),sx:{marginTop:1},onClick:function(){let e=`column_${Object.keys(t).length}`,l=[...t];l.push({name:e}),n(l),o(e=>(e.push(!1),[...e]))},children:"Add Column Settings"})]})}var $=n(75712),F=n(85180);function L(e){let{kind:t,spec:n,queryResults:l}=e,{ref:i,width:o=1,height:r=1}=(0,F.default)();return(0,c.jsx)("div",{ref:i,style:{height:"100%"},children:(0,c.jsx)(v.ErrorBoundary,{FallbackComponent:v.ErrorAlert,children:(0,c.jsx)($.PanelPluginLoader,{kind:t,contentDimensions:{width:o,height:r},spec:n,queryResults:l})})})}var I=n(22810),P=n(56599),W=n(74628);function H(e){let{allValues:t,selectedValues:n,onFilterChange:l,theme:i}=e,o=[...new Set(t)].filter(e=>null!=e).sort();return 0===o.length?(0,c.jsx)("div",{"data-filter-dropdown":!0,style:{width:200,padding:10,backgroundColor:i.palette.background.paper,border:`1px solid ${i.palette.divider}`,borderRadius:4,boxShadow:i.shadows[4]},children:(0,c.jsx)("div",{style:{color:i.palette.text.secondary,fontSize:14},children:"No values found"})}):(0,c.jsxs)("div",{"data-filter-dropdown":!0,style:{width:200,padding:10,backgroundColor:i.palette.background.paper,border:`1px solid ${i.palette.divider}`,borderRadius:4,boxShadow:i.shadows[4],maxHeight:250,overflowY:"auto"},children:[(0,c.jsx)("div",{style:{marginBottom:8,fontSize:14,fontWeight:"bold"},children:(0,c.jsxs)("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,c.jsx)("input",{type:"checkbox",checked:n.length===o.length&&o.length>0,onChange:e=>l(e.target.checked?o:[]),style:{marginRight:8}}),(0,c.jsxs)("span",{style:{color:i.palette.text.primary},children:["Select All (",o.length,")"]})]})}),(0,c.jsx)("hr",{style:{margin:"8px 0",border:"none",borderTop:`1px solid ${i.palette.divider}`}}),o.map((e,t)=>(0,c.jsx)("div",{style:{marginBottom:4},children:(0,c.jsxs)("label",{style:{display:"flex",alignItems:"center",cursor:"pointer",padding:"2px 0",borderRadius:2},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=i.palette.action.hover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[(0,c.jsx)("input",{type:"checkbox",checked:n.includes(e),onChange:t=>{t.target.checked?l([...n,e]):l(n.filter(t=>t!==e))},style:{marginRight:8}}),(0,c.jsx)("span",{style:{fontSize:14,color:i.palette.text.primary},children:null==e||""===e?"(empty)":String(e)})]})},`value-${t}`))]})}function V(e,t){for(let n of t)if(n.name===e){if(n.hide)return;let{name:e,header:t,headerDescription:l,enableSorting:i,width:o,align:r,dataLink:a}=n;return{accessorKey:e,header:t??e,headerDescription:l,enableSorting:i,width:o,align:r,dataLink:a,...function(e){let t=e.plugin;return void 0!==t?{cell:e=>{let n=e.getValue();return n?(0,c.jsx)(L,{kind:t.kind,spec:t.spec,queryResults:[n]}):(0,c.jsx)(c.Fragment,{})},cellDescription:e.cellDescription?()=>`${e.cellDescription}`:()=>""}:{cell:t=>{let n=t.getValue();return"number"==typeof n&&e.format?(0,I.formatValue)(n,e.format):n},cellDescription:e.cellDescription?()=>`${e.cellDescription}`:void 0}}(n)}}return{accessorKey:e,header:e}}function U(e){return{mode:(e.columnSettings??[]).some(e=>e.plugin)?"range":"instant"}}function B(e){let{label:t,defaultValue:n,value:l,onChange:i}=e;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(v.OptionsEditorControl,{label:`Auto Columns ${t}`,control:(0,c.jsx)(A.A,{checked:void 0===l||"auto"===l,onChange:function(e,t){if(t)return i("auto");i(n)}})}),void 0!==l&&"auto"!==l&&(0,c.jsx)(v.OptionsEditorControl,{label:`Default Columns ${t}`,control:(0,c.jsx)(o.A,{type:"number",value:l??n,slotProps:{input:{inputProps:{min:1,step:1}}},onChange:e=>i(parseInt(e.target.value))})})]})}let G={PanelComponent:function(e){var t;let{contentDimensions:n,spec:i,queryResults:o}=e,r=(0,P.A)(),a=U(i).mode,u=(0,l.useMemo)(()=>o.flatMap((e,t)=>e.data.series.map(n=>({data:e,ts:n,queryIndex:t}))).map(e=>{var t;let{data:n,ts:l,queryIndex:r}=e;if(void 0===l.values[0])return{...l.labels};let s=1===o.length?"value":`value #${r+1}`,d=1===o.length?l.labels:Object.entries(l.labels??{}).reduce((e,t)=>{let[n,l]=t;return n&&(e[`${n} #${r+1}`]=l),e},{}),c=(null==(t=(i.columnSettings??[]).find(e=>e.name===s))?void 0:t.plugin)?{...n,data:{...n.data,series:n.data.series.filter(e=>e===l)}}:l.values[0][1];return"instant"===a?{timestamp:l.values[0][0],[s]:c,...d}:{[s]:c,...d}}),[o,a,i.columnSettings]),h=(0,I.transformData)(u,i.transforms??[]),p=(0,l.useMemo)(()=>{let e=[];for(let t of h)for(let n of Object.keys(t))e.includes(n)||e.push(n);return e},[h]),g=(0,l.useMemo)(()=>{let e={};return p.forEach(t=>{let n=h.map(e=>e[t]).filter(e=>null!=e&&""!==e);e[t]=Array.from(new Set(n))}),e},[h,p]),x=(0,l.useMemo)(()=>{let e=[],t=new Set;for(let n of i.columnSettings??[]){if(t.has(n.name))continue;let l=V(n.name,i.columnSettings??[]);void 0!==l&&(e.push(l),t.add(n.name))}if(!i.defaultColumnHidden){for(let n of p)if(!t.has(n)){let t=V(n,i.columnSettings??[]);void 0!==t&&e.push(t)}}return e},[p,i.columnSettings,i.defaultColumnHidden]),m=(0,l.useMemo)(()=>{var e,t,n;if(void 0===i.cellSettings&&!(null==(e=i.columnSettings)?void 0:e.some(e=>void 0!==e.cellSettings)))return{};let l={},o=0;for(let e of h){for(let[r,a]of Object.entries({...p.reduce((e,t)=>(e[t]=void 0,e),{}),...e})){let e=d(a,i.cellSettings??[]),s=null==(t=i.columnSettings)?void 0:t.find(e=>e.name===r);if(null==s||null==(n=s.cellSettings)?void 0:n.length){let t=d(a,s.cellSettings);t&&(e=t)}e&&(l[`${o}_${r}`]=e)}o++}return l},[h,p,i.cellSettings,i.columnSettings]),[f,j]=(0,l.useState)((null==(t=i.columnSettings)?void 0:t.filter(e=>void 0!==e.sort).map(e=>({id:e.name,desc:"desc"===e.sort})))??[]),[C,b]=(0,l.useState)([]),[A,k]=(0,l.useState)({}),[y,S]=(0,l.useState)(null);(0,l.useEffect)(()=>{if(!y)return;let e=e=>{let t=e.target;t.closest("[data-filter-dropdown]")||t.closest("button")||(k({}),S(null))},t=setTimeout(()=>{document.addEventListener("click",e)},100);return()=>{clearTimeout(t),document.removeEventListener("click",e)}},[y]);let E=(0,l.useMemo)(()=>{let e=[...h];return i.enableFiltering&&C.length>0&&(e=e.filter(e=>C.every(t=>{let n=e[t.id],l=t.value;return!l||0===l.length||l.includes(n)}))),e},[h,C,i.enableFiltering]),[w,O]=(0,l.useState)(i.pagination?{pageIndex:0,pageSize:10}:void 0);return((0,l.useEffect)(()=>{i.pagination&&!w?O({pageIndex:0,pageSize:10}):!i.pagination&&w&&O(void 0)},[i.pagination,w]),void 0===n)?null:(null==h?void 0:h.length)?(0,c.jsxs)(c.Fragment,{children:[i.enableFiltering&&(0,c.jsx)("div",{style:{display:"flex",background:r.palette.background.default,borderBottom:`1px solid ${r.palette.divider}`,width:n.width,boxSizing:"border-box"},children:x.map((e,t)=>{var n;let l,o=(n=e.accessorKey,(l=C.find(e=>e.id===n))?l.value:[]),a=e.width||i.defaultColumnWidth;return(0,c.jsxs)("div",{style:{padding:"8px",borderRight:t<x.length-1?`1px solid ${r.palette.divider}`:"none",width:a,minWidth:a,maxWidth:a,display:"flex",alignItems:"center",position:"relative",boxSizing:"border-box",flex:"number"==typeof a?"none":"1 1 auto"},children:[(0,c.jsx)("span",{style:{marginRight:8,fontSize:"12px",color:r.palette.text.secondary,flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:o.length?`${o.length} items`:"All"}),(0,c.jsx)("button",{onClick:t=>{var n;n=e.accessorKey,t.preventDefault(),t.stopPropagation(),k({...A,[n]:t.currentTarget}),S(n)},style:{border:`1px solid ${r.palette.divider}`,background:r.palette.background.paper,cursor:"pointer",fontSize:"12px",color:o.length?r.palette.primary.main:r.palette.text.secondary,padding:"4px 8px",borderRadius:"4px",minWidth:"20px",height:"24px",flexShrink:0,transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background=r.palette.action.hover},onMouseLeave:e=>{e.currentTarget.style.background=r.palette.background.paper},type:"button",children:"â–¼"}),y===e.accessorKey&&(0,c.jsx)("div",{style:{position:"absolute",top:"100%",left:0,zIndex:1e3,marginTop:4},children:(0,c.jsx)(H,{allValues:g[e.accessorKey]||[],selectedValues:o,onFilterChange:t=>{var n;let l;return n=e.accessorKey,l=C.filter(e=>e.id!==n),void(t.length>0&&l.push({id:n,value:t}),b(l))},theme:r})})]},`filter-${t}`)})}),(0,c.jsx)(v.Table,{data:E,columns:x,cellConfigs:m,height:i.enableFiltering?n.height-40:n.height,width:n.width,density:i.density,defaultColumnWidth:i.defaultColumnWidth,defaultColumnHeight:i.defaultColumnHeight,sorting:f,onSortingChange:j,pagination:w,onPaginationChange:O})]}):(0,c.jsx)(W.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,c.jsx)(s.A,{children:"No data"})})},supportedQueryTypes:["TimeSeriesQuery"],queryOptions:U,panelOptionsEditorComponents:[{label:"General Settings",content:function(e){let{onChange:t,value:n}=e;return(0,c.jsx)(v.OptionsEditorGrid,{children:(0,c.jsx)(v.OptionsEditorColumn,{children:(0,c.jsxs)(v.OptionsEditorGroup,{title:"Display",children:[(0,c.jsx)(v.DensitySelector,{value:n.density,onChange:function(e){t({...n,density:e})}}),(0,c.jsx)(v.OptionsEditorControl,{label:"Pagination",control:(0,c.jsx)(A.A,{checked:!!n.pagination,onChange:function(e,l){t({...n,pagination:l})}})}),(0,c.jsx)(v.OptionsEditorControl,{label:"Columns Hidden by Default",control:(0,c.jsx)(A.A,{checked:!!n.defaultColumnHidden,onChange:function(e,l){t({...n,defaultColumnHidden:l})}})}),(0,c.jsx)(v.OptionsEditorControl,{label:"Enable Column Filtering",control:(0,c.jsx)(A.A,{checked:!!n.enableFiltering,onChange:function(e,l){t({...n,enableFiltering:l})}})}),(0,c.jsx)(B,{label:"Width",defaultValue:v.DEFAULT_COLUMN_WIDTH,value:n.defaultColumnWidth,onChange:function(e){t({...n,defaultColumnWidth:e})}}),(0,c.jsx)(B,{label:"Height",defaultValue:v.DEFAULT_COLUMN_HEIGHT,value:n.defaultColumnHeight,onChange:function(e){t({...n,defaultColumnHeight:e})}})]})})})}},{label:"Column Settings",content:function(e){let{onChange:t,value:n}=e;return(0,c.jsx)(R,{columnSettings:n.columnSettings??[],onChange:function(e){t({...n,columnSettings:e})}})}},{label:"Cell Settings",content:function(e){let{onChange:t,value:n}=e;return(0,c.jsx)(b,{cellSettings:n.cellSettings??[],onChange:function(e){t({...n,cellSettings:e})}})}},{label:"Transforms",content:function(e){let{value:t,onChange:n}=e;return(0,c.jsx)(v.TransformsEditor,{value:t.transforms??[],onChange:function(e){n({...t,transforms:e})}})}}],createInitialOptions:function(){return{density:"standard",enableFiltering:!0}}}}}]);