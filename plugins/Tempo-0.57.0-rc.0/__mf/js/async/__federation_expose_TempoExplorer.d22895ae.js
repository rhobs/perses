"use strict";(self.chunk_Tempo=self.chunk_Tempo||[]).push([["1829"],{56627:function(e,r,a){a.r(r),a.d(r,{TempoExplorer:()=>A});var n=a(62540),s=a(315),i=a(74628),l=a(34007),t=a(37266),p=a(33862),c=a(75712),u=a(56432),o=a(57744),d=a(70451);let h=new URLSearchParams({explorer:"Tempo-TempoExplorer",data:JSON.stringify({queries:[{kind:"TraceQuery",spec:{plugin:{kind:"TempoTraceQuery",spec:{query:"TRACEID",datasource:{kind:"TempoDatasource",name:"DATASOURCENAME"}}}}}]})}),x=new URLSearchParams({explorer:"Tempo-TempoExplorer",data:JSON.stringify({queries:[{kind:"TraceQuery",spec:{plugin:{kind:"TempoTraceQuery",spec:{query:"TRACEID",datasource:{kind:"TempoDatasource",name:"DATASOURCENAME"}}}}}],spanId:"SPANID"})}),T=`/explore?${h}`.replace("DATASOURCENAME","${datasourceName}").replace("TRACEID","${traceId}"),m=`/explore?${x}`.replace("DATASOURCENAME","${datasourceName}").replace("TRACEID","${traceId}").replace("SPANID","${spanId}");function y(e){let{queries:r}=e,{isFetching:a,isLoading:p,queryResults:u}=(0,o.useDataQueries)("TraceQuery");if(0===u.length)return(0,n.jsx)(n.Fragment,{});if(p||a)return(0,n.jsx)(t.LoadingOverlay,{});let d=u.find(e=>e.error);if(d)throw d.error;if(!u.some(e=>{var r;return((null==(r=e.data)?void 0:r.searchResult)??[]).length>0}))return(0,n.jsx)(t.NoDataOverlay,{resource:"traces"});let h=u.some(e=>{var r,a;return null==(a=e.data)||null==(r=a.metadata)?void 0:r.hasMoreResults});return(0,n.jsxs)(s.A,{sx:{height:"100%"},gap:2,children:[(0,n.jsx)(i.A,{sx:{height:"35%",flexShrink:0},children:(0,n.jsx)(c.Panel,{panelOptions:{hideHeader:!0},definition:{kind:"Panel",spec:{queries:r,display:{name:""},plugin:{kind:"ScatterChart",spec:{link:T}}}}})}),(0,n.jsx)(c.Panel,{sx:{flexGrow:1},panelOptions:{hideHeader:!0},definition:{kind:"Panel",spec:{queries:r,display:{name:""},plugin:{kind:"TraceTable",spec:{links:{trace:T}}}}}}),h&&(0,n.jsx)(l.A,{severity:"info",children:"Not all matching traces are currently displayed. Increase the result limit to view additional traces."})]})}function g(e){var r,a;let{queries:s,selectedSpanId:i}=e,l=null==(a=s[0])||null==(r=a.spec.plugin.spec)?void 0:r.query;return(0,n.jsx)(c.Panel,{panelOptions:{showIcons:"always"},definition:{kind:"Panel",spec:{queries:s,display:{name:`Trace ${l}`},plugin:{kind:"TracingGanttChart",spec:{links:{trace:T,span:m},selectedSpanId:i}}}}})}function A(){var e,r;let{data:{queries:a=[],spanId:l},setData:c}=(0,u.useExplorerManagerContext)(),[h,x]=(0,d.useState)(a),T=a.length?a.map(e=>({kind:e.spec.plugin.kind,spec:e.spec.plugin.spec})):[],m=null==(r=a[0])||null==(e=r.spec.plugin.spec)?void 0:e.query,A=(0,p.h)(m??"");return(0,n.jsxs)(s.A,{gap:2,sx:{width:"100%"},children:[(0,n.jsx)(o.MultiQueryEditor,{queryTypes:["TraceQuery"],onChange:e=>x(e),queries:h,onQueryRun:()=>c({queries:h})}),(0,n.jsx)(t.ErrorBoundary,{FallbackComponent:t.ErrorAlert,resetKeys:[a],children:(0,n.jsx)(o.DataQueriesProvider,{definitions:T,children:(0,n.jsx)(i.A,{height:700,children:A?(0,n.jsx)(g,{queries:a,selectedSpanId:l}):(0,n.jsx)(y,{queries:a})})})})]})}}}]);