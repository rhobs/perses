/*! For license information please see __federation_expose_VictoriaLogsFieldValuesVariable.fe63dd85.js.LICENSE.txt */
"use strict";(self.chunk_VictoriaLogs=self.chunk_VictoriaLogs||[]).push([["4209"],{2192:function(e,a,r){var t=r(70451),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n={key:!0,ref:!0,__self:!0,__source:!0};function u(e,a,r){var t,i={},u=null,c=null;for(t in void 0!==r&&(u=""+r),void 0!==a.key&&(u=""+a.key),void 0!==a.ref&&(c=a.ref),a)l.call(a,t)&&!n.hasOwnProperty(t)&&(i[t]=a[t]);if(e&&e.defaultProps)for(t in a=e.defaultProps)void 0===i[t]&&(i[t]=a[t]);return{$$typeof:o,type:e,key:u,ref:c,props:i,_owner:s.current}}a.Fragment=i,a.jsx=u,a.jsxs=u},62540:function(e,a,r){e.exports=r(2192)},50095:function(e,a,r){r.d(a,{H6:()=>s,m_:()=>o,fZ:()=>l,jx:()=>i});var t=r(57744);let o="VictoriaLogsDatasource",i={kind:o};function l(e){return!(0,t.isVariableDatasource)(e)&&void 0===e.name}function s(e){return(0,t.isVariableDatasource)(e)||e.kind===o}},92229:function(e,a,r){r.d(a,{Iq:()=>i,RG:()=>l,gZ:()=>s});var t=r(57744),o=r(91807);let i=e=>e?e.map(e=>({value:e.value,label:e.value})):[];function l(e){let{start:a,end:r}=e;return{start:a.toISOString(),end:r.toISOString()}}function s(e,a){let{absoluteTimeRange:{start:r,end:i}}=(0,t.useTimeRange)(),{data:l}=(0,t.useDatasourceClient)(a),s=!!l&&!!e;return(0,o.useQuery)({enabled:s,queryKey:["datasource",a.name,"query",e],queryFn:async()=>await l.fieldNames({start:r.toISOString(),end:i.toISOString(),query:e})})}},85624:function(e,a,r){r.r(a),r.d(a,{VictoriaLogsFieldValuesVariable:()=>b});var t=r(57744),o=r(50095),i=r(62540),l=r(315),s=r(67987),n=r(5611),u=r(93648),c=r(38662),d=r(70451),f=r(92229);let b={getVariableOptions:async(e,a)=>{let r=(0,t.datasourceSelectValueToSelector)(e.datasource??o.jx,a.variables,await a.datasourceStore.listDatasourceSelectItems(o.m_))??o.jx,i=await a.datasourceStore.getDatasourceClient(r),l=(0,t.replaceVariables)(e.query,a.variables),s=(0,f.RG)(a.timeRange),{values:n}=l?await i.fieldValues({field:(0,t.replaceVariables)(e.field,a.variables),query:l,...s}):{values:[]};return{data:(0,f.Iq)(n)}},dependsOn:e=>({variables:[...(0,t.parseVariables)(e.query),...(0,t.parseVariables)(e.field),...e.datasource&&(0,t.isVariableDatasource)(e.datasource)?(0,t.parseVariables)(e.datasource):[]]}),OptionsEditorComponent:function(e){let{onChange:a,value:r,value:{datasource:b,query:p,field:v}}=e,g=b??o.jx,y=(0,t.useDatasourceSelectValueToSelector)(g,o.m_),{data:V,isLoading:S}=(0,f.gZ)(p,y),m=(0,d.useCallback)(e=>{if((0,t.isVariableDatasource)(e)||(0,o.H6)(e))return void a((0,c.jM)(r,a=>{a.datasource=!(0,t.isVariableDatasource)(e)&&(0,o.fZ)(e)?void 0:e}));throw Error("Got unexpected non-VictoriaLogs datasource selector")},[a,r]),_=(0,d.useCallback)(e=>{a((0,c.jM)(r,a=>{a.query=e.target.value}))},[a,r]),O=(0,d.useCallback)((e,t)=>{a((0,c.jM)(r,e=>{e.field=t||""}))},[a,r]),j=(0,d.useMemo)(()=>(null==V?void 0:V.values.map(e=>e.value))||[],[V]);return(0,i.jsxs)(l.A,{spacing:2,children:[(0,i.jsx)(s.A,{margin:"dense",children:(0,i.jsx)(t.DatasourceSelect,{datasourcePluginKind:"VictoriaLogsDatasource",value:g,onChange:m,readOnly:e.isReadonly,labelId:"victorialogs-datasource-field",label:"VictoriaLogs Datasource"})}),(0,i.jsx)(n.A,{freeSolo:!0,disableClearable:!0,value:v,loading:S,options:j,renderInput:e=>(0,i.jsx)(u.A,{...e,required:!0,label:"Field Name",variant:"outlined"}),onChange:O}),(0,i.jsx)(u.A,{required:!0,label:"Query",InputLabelProps:{shrink:!!e.isReadonly||void 0},InputProps:{readOnly:e.isReadonly},value:p,onChange:_})]})},createInitialOptions:()=>({field:"",query:""})}}}]);