/*! For license information please see __federation_expose_ClickHouseTimeSeriesQuery.72a6549b.js.LICENSE.txt */
"use strict";(self.chunk_ClickHouse=self.chunk_ClickHouse||[]).push([["293"],{2192:function(e,t,r){var a=r(70451),i=Symbol.for("react.element"),n=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var a,n={},l=null,c=null;for(a in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,a)&&!u.hasOwnProperty(a)&&(n[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===n[a]&&(n[a]=t[a]);return{$$typeof:i,type:e,key:l,ref:c,props:n,_owner:s.current}}t.Fragment=n,t.jsx=l,t.jsxs=l},62540:function(e,t,r){e.exports=r(2192)},15062:function(e,t,r){r.d(t,{t:()=>a});let a=`-- Time Series Query
SELECT 
  toStartOfMinute(timestamp) as time,
  avg(cpu_usage) as avg_cpu,
  max(memory_usage) as max_memory
FROM system_metrics 
WHERE timestamp BETWEEN '{start}' AND '{end}'
GROUP BY time ORDER BY time
-- Logs Query  
SELECT 
  Timestamp as log_time,
  Body,
  ServiceName,
  ResourceAttributes,
  SeverityNumber,
  SeverityText
FROM application_logs 
WHERE timestamp >= '{start}' 
ORDER BY time DESC LIMIT 1000`},21261:function(e,t,r){r.d(t,{N:()=>l});var a=r(62540),i=r(29068),n=r(41865),o=r(56599),s=r(315),u=r(54227);function l(e){let t=(0,o.A)(),r="dark"===t.palette.mode;return(0,a.jsxs)(s.A,{position:"relative",children:[(0,a.jsx)(u.A,{sx:{fontWeight:500,marginBottom:"4px",color:t.palette.text.primary},children:"ClickHouse Query"}),(0,a.jsx)(i.Ay,{...e,style:{border:`1px solid ${t.palette.divider}`},theme:r?"dark":"light",basicSetup:{highlightActiveLine:!1,highlightActiveLineGutter:!1,foldGutter:!1,syntaxHighlighting:!0},extensions:[n.Lz.lineWrapping,n.Lz.theme({".cm-content":{paddingTop:"8px",paddingBottom:"8px",paddingRight:"40px"}})],placeholder:"Write ClickHouse Query Here..."})]})}},20398:function(e,t,r){r.r(t),r.d(t,{ClickHouseTimeSeriesQuery:()=>y,ClickHouseTimeSeriesQueryEditor:()=>m,getTimeSeriesData:()=>n});var a=r(57744),i=r(7140);let n=async(e,t)=>{var r;if(void 0===e.query||null===e.query||""===e.query)return{series:[]};let n=(0,a.replaceVariables)(e.query,t.variableState),o=await t.datasourceStore.getDatasourceClient(e.datasource??i.S),{start:s,end:u}=t.timeRange;return{series:(r=await o.query({start:s.getTime().toString(),end:u.getTime().toString(),query:n}))&&r.data&&0!==r.data.length?[{name:"log_count",values:r.data.map(e=>[new Date(e.time).getTime(),Number(e.log_count)])}]:[],timeRange:{start:s,end:u},stepMs:3e4,metadata:{executedQueryString:n}}};var o=r(62540),s=r(70451),u=r(38662),l=r(315),c=r(21261),d=r(15062),p=r(64383);function m(e){let{onChange:t,value:r}=e,{datasource:n}=r,m=n??i.S,{query:y,handleQueryChange:g,handleQueryBlur:f}=(0,p.Z)(e),h=(0,s.useCallback)(e=>{g(e)},[g]);return(0,o.jsxs)(l.A,{spacing:1.5,children:[(0,o.jsx)(a.DatasourceSelect,{datasourcePluginKind:i.N,value:m,onChange:e=>{if(!(0,a.isVariableDatasource)(e)&&e.kind===i.N)return void t((0,u.jM)(r,t=>{t.datasource=e}));throw Error("Got unexpected non ClickHouse datasource selection")},label:"ClickHouse Datasource",notched:!0}),(0,o.jsx)(c.N,{value:y,onChange:h,onBlur:f,onKeyDown:e=>{"Enter"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),t((0,u.jM)(r,e=>{e.query=y})))},placeholder:"Enter ClickHouse SQL query"}),(0,o.jsxs)("details",{children:[(0,o.jsx)("summary",{style:{cursor:"pointer",fontSize:"12px",color:"#666",marginBottom:"8px"},children:"Query Examples"}),(0,o.jsx)("div",{style:{fontSize:"11px",color:"#777",backgroundColor:"#f5f5f5",padding:"8px",borderRadius:"4px",fontFamily:'Monaco, Menlo, "Ubuntu Mono", monospace',whiteSpace:"pre-wrap",lineHeight:"1.3"},children:d.t})]})]})}let y={getTimeSeriesData:n,OptionsEditorComponent:m,createInitialOptions:()=>({query:""}),dependsOn:e=>({variables:[...new Set([...(0,a.parseVariables)(e.query)])]})}},7140:function(e,t,r){r.d(t,{N:()=>a,S:()=>i});let a="ClickHouseDatasource",i={kind:a}},64383:function(e,t,r){r.d(t,{Z:()=>n});var a=r(70451),i=r(38662);function n(e){let{onChange:t,value:r}=e,[n,o]=(0,a.useState)(r.query||""),[s,u]=(0,a.useState)(r.query);return r.query!==s&&(o(r.query||""),u(r.query)),{query:n,handleQueryChange:e=>{o(e)},handleQueryBlur:()=>{u(n),t((0,i.jM)(r,e=>{e.query=n}))}}}}}]);