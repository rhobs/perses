"use strict";(self.chunk_Prometheus=self.chunk_Prometheus||[]).push([["5306"],{4150:function(e,a,l){var r;a.default=void 0,a.default=(0,((r=l(1448))&&r.__esModule?r:{default:r}).default)("M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M9,8H11V17H9V8M13,8H15V17H13V8Z","TrashCan")},68262:function(e,a,l){l.r(a),l.d(a,{PrometheusPromQLVariable:()=>o});var r=l(57744),t=l(3412),s=l(30774);let o={getVariableOptions:async(e,a)=>{let l=(0,r.datasourceSelectValueToSelector)(e.datasource??t.hu,a.variables,await a.datasourceStore.listDatasourceSelectItems(t.eU))??t.hu,o=await a.datasourceStore.getDatasourceClient(l),{data:u}=await o.instantQuery({query:(0,r.replaceVariables)(e.expr,a.variables)}),n=(0,r.replaceVariables)(e.labelName,a.variables),i=[];return(null==u?void 0:u.resultType)==="matrix"?i=(0,s.Z$)(u,n):(null==u?void 0:u.resultType)==="vector"&&(i=(0,s.xo)(u,n)),{data:(0,s.so)(i)}},dependsOn:e=>({variables:[...(0,r.parseVariables)(e.expr),...(0,r.parseVariables)(e.labelName),...e.datasource&&(0,r.isVariableDatasource)(e.datasource)?(0,r.parseVariables)(e.datasource):[]]}),OptionsEditorComponent:s.RH,createInitialOptions:()=>({expr:"",labelName:""})}},30774:function(e,a,l){l.d(a,{kE:()=>j,Z$:()=>V,xo:()=>g,RH:()=>f,so:()=>y,Y8:()=>x});var r=l(62540),t=l(315),s=l(67987),o=l(93648),u=l(57744),n=l(38662),i=l(70451),c=l(24340),d=l(3412),b=l(74628),h=l(47095),m=l(7013),p=l(4150);function v(e){let{matchers:a,onChange:l,isReadonly:s}=e;return(0,r.jsxs)(t.A,{spacing:1,mb:2,children:[a.map((e,t)=>(0,r.jsxs)(b.A,{display:"flex",children:[(0,r.jsx)(o.A,{fullWidth:!0,label:"Series Selector",value:e,InputProps:{readOnly:s},onChange:e=>{l((0,n.jM)(a,a=>{a[t]=e.target.value}))}}),(0,r.jsx)(h.A,{onClick:()=>{l((0,n.jM)(a,e=>{e.splice(t,1)}))},disabled:s,children:(0,r.jsx)(p.default,{})})]},t)),(0,r.jsx)(b.A,{children:(0,r.jsx)(m.A,{fullWidth:!1,color:"secondary",variant:"outlined",onClick:()=>{l((0,n.jM)(a,e=>{e.push("")}))},disabled:s,children:"Add Series Selector"})})]})}function x(e){let{onChange:a,value:l,value:{datasource:c}}=e,b=c??d.hu,h=(0,i.useCallback)(e=>{if((0,u.isVariableDatasource)(e)||(0,d.ZO)(e))return void a((0,n.jM)(l,a=>{a.datasource=!(0,u.isVariableDatasource)(e)&&(0,d.do)(e)?void 0:e}));throw Error("Got unexpected non-Prometheus datasource selector")},[a,l]),m=(0,i.useCallback)(e=>{a((0,n.jM)(l,a=>{a.labelName=e.target.value}))},[a,l]),p=(0,i.useCallback)(e=>{a((0,n.jM)(l,a=>{a.matchers=e}))},[a,l]);return(0,r.jsxs)(t.A,{spacing:2,children:[(0,r.jsx)(s.A,{margin:"dense",children:(0,r.jsx)(u.DatasourceSelect,{datasourcePluginKind:"PrometheusDatasource",value:b,onChange:h,readOnly:e.isReadonly,labelId:"prom-datasource-label",label:"Prometheus Datasource"})}),(0,r.jsx)(o.A,{label:"Label Name",required:!0,value:e.value.labelName,onChange:m,slotProps:{input:{readOnly:e.isReadonly}}}),(0,r.jsx)(v,{matchers:e.value.matchers??[],onChange:p,isReadonly:e.isReadonly})]})}function j(e){let{onChange:a,value:l,value:{datasource:o}}=e,c=o??d.hu,b=(0,i.useCallback)(e=>{if((0,u.isVariableDatasource)(e)||(0,d.ZO)(e))return void a((0,n.jM)(l,a=>{a.datasource=!(0,u.isVariableDatasource)(e)&&(0,d.do)(e)?void 0:e}));throw Error("Got unexpected non-Prometheus datasource selector")},[a,l]),h=(0,i.useCallback)(e=>{a((0,n.jM)(l,a=>{a.matchers=e}))},[a,l]);return(0,r.jsxs)(t.A,{spacing:2,children:[(0,r.jsx)(s.A,{margin:"dense",children:(0,r.jsx)(u.DatasourceSelect,{datasourcePluginKind:"PrometheusDatasource",value:c,onChange:b,disabled:e.isReadonly,labelId:"prom-datasource-label",label:"Prometheus Datasource"})}),(0,r.jsx)(v,{matchers:e.value.matchers??[],isReadonly:e.isReadonly,onChange:h})]})}function f(e){let{onChange:a,value:l,value:{datasource:b}}=e,h=b??d.hu,m=(0,u.useDatasourceSelectValueToSelector)(h,d.eU),{data:p}=(0,u.useDatasourceClient)(m),v=null==p?void 0:p.options.datasourceUrl,x=(0,i.useCallback)(e=>{if((0,u.isVariableDatasource)(e)||(0,d.ZO)(e))return void a((0,n.jM)(l,a=>{a.datasource=!(0,u.isVariableDatasource)(e)&&(0,d.do)(e)?void 0:e}));throw Error("Got unexpected non-Prometheus datasource selector")},[l,a]),j=(0,i.useCallback)(e=>{a((0,n.jM)(l,a=>{a.expr=e.target.textContent??""}))},[a,l]),f=(0,i.useCallback)(e=>{a((0,n.jM)(l,a=>{a.labelName=e.target.value}))},[a,l]);return(0,r.jsxs)(t.A,{spacing:2,children:[(0,r.jsx)(s.A,{margin:"dense",children:(0,r.jsx)(u.DatasourceSelect,{datasourcePluginKind:d.eU,value:h,onChange:x,labelId:"prom-datasource-label",label:"Prometheus Datasource",disabled:e.isReadonly})}),(0,r.jsx)(c.T,{completeConfig:{remote:{url:v}},value:l.expr,datasource:m,onBlur:j,readOnly:e.isReadonly,width:"100%"}),(0,r.jsx)(o.A,{label:"Label Name",required:!0,value:e.value.labelName,slotProps:{input:{readOnly:e.isReadonly}},onChange:f})]})}function V(e,a){let l=new Set;for(let r of e.result){let e=r.metric[a];void 0!==e&&l.add(e)}return Array.from(l.values())}function g(e,a){let l=new Set;for(let r of e.result){let e=r.metric[a];void 0!==e&&l.add(e)}return Array.from(l.values())}let y=e=>e?e.map(e=>({value:e,label:e})):[]}}]);