"use strict";(self.chunk_Prometheus=self.chunk_Prometheus||[]).push([["3039"],{4150:function(e,a,l){var r;a.default=void 0,a.default=(0,((r=l(1448))&&r.__esModule?r:{default:r}).default)("M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M9,8H11V17H9V8M13,8H15V17H13V8Z","TrashCan")},36029:function(e,a,l){l.r(a),l.d(a,{PrometheusLabelNamesVariable:()=>o});var r=l(57744),t=l(3412),s=l(30774);let o={getVariableOptions:async(e,a)=>{let l=(0,r.datasourceSelectValueToSelector)(e.datasource??t.hu,a.variables,await a.datasourceStore.listDatasourceSelectItems(t.eU))??t.hu,o=await a.datasourceStore.getDatasourceClient(l),u=e.matchers?e.matchers.map(e=>(0,r.replaceVariables)(e,a.variables)):void 0,n=(0,t.LY)(a.timeRange),{data:i}=await o.labelNames({"match[]":u,...n});return{data:(0,s.so)(i)}},dependsOn:e=>{var a;return{variables:[...(null==(a=e.matchers)?void 0:a.map(e=>(0,r.parseVariables)(e)).flat())||[],...e.datasource&&(0,r.isVariableDatasource)(e.datasource)?(0,r.parseVariables)(e.datasource):[]]}},OptionsEditorComponent:s.kE,createInitialOptions:()=>({})}},30774:function(e,a,l){l.d(a,{kE:()=>f,Z$:()=>g,xo:()=>C,RH:()=>x,so:()=>V,Y8:()=>j});var r=l(62540),t=l(315),s=l(67987),o=l(93648),u=l(57744),n=l(38662),i=l(70451),c=l(24340),d=l(3412),h=l(74628),b=l(47095),m=l(7013),v=l(4150);function p(e){let{matchers:a,onChange:l,isReadonly:s}=e;return(0,r.jsxs)(t.A,{spacing:1,mb:2,children:[a.map((e,t)=>(0,r.jsxs)(h.A,{display:"flex",children:[(0,r.jsx)(o.A,{fullWidth:!0,label:"Series Selector",value:e,InputProps:{readOnly:s},onChange:e=>{l((0,n.jM)(a,a=>{a[t]=e.target.value}))}}),(0,r.jsx)(b.A,{onClick:()=>{l((0,n.jM)(a,e=>{e.splice(t,1)}))},disabled:s,children:(0,r.jsx)(v.default,{})})]},t)),(0,r.jsx)(h.A,{children:(0,r.jsx)(m.A,{fullWidth:!1,color:"secondary",variant:"outlined",onClick:()=>{l((0,n.jM)(a,e=>{e.push("")}))},disabled:s,children:"Add Series Selector"})})]})}function j(e){let{onChange:a,value:l,value:{datasource:c}}=e,h=c??d.hu,b=(0,i.useCallback)(e=>{if((0,u.isVariableDatasource)(e)||(0,d.ZO)(e))return void a((0,n.jM)(l,a=>{a.datasource=!(0,u.isVariableDatasource)(e)&&(0,d.do)(e)?void 0:e}));throw Error("Got unexpected non-Prometheus datasource selector")},[a,l]),m=(0,i.useCallback)(e=>{a((0,n.jM)(l,a=>{a.labelName=e.target.value}))},[a,l]),v=(0,i.useCallback)(e=>{a((0,n.jM)(l,a=>{a.matchers=e}))},[a,l]);return(0,r.jsxs)(t.A,{spacing:2,children:[(0,r.jsx)(s.A,{margin:"dense",children:(0,r.jsx)(u.DatasourceSelect,{datasourcePluginKind:"PrometheusDatasource",value:h,onChange:b,readOnly:e.isReadonly,labelId:"prom-datasource-label",label:"Prometheus Datasource"})}),(0,r.jsx)(o.A,{label:"Label Name",required:!0,value:e.value.labelName,onChange:m,slotProps:{input:{readOnly:e.isReadonly}}}),(0,r.jsx)(p,{matchers:e.value.matchers??[],onChange:v,isReadonly:e.isReadonly})]})}function f(e){let{onChange:a,value:l,value:{datasource:o}}=e,c=o??d.hu,h=(0,i.useCallback)(e=>{if((0,u.isVariableDatasource)(e)||(0,d.ZO)(e))return void a((0,n.jM)(l,a=>{a.datasource=!(0,u.isVariableDatasource)(e)&&(0,d.do)(e)?void 0:e}));throw Error("Got unexpected non-Prometheus datasource selector")},[a,l]),b=(0,i.useCallback)(e=>{a((0,n.jM)(l,a=>{a.matchers=e}))},[a,l]);return(0,r.jsxs)(t.A,{spacing:2,children:[(0,r.jsx)(s.A,{margin:"dense",children:(0,r.jsx)(u.DatasourceSelect,{datasourcePluginKind:"PrometheusDatasource",value:c,onChange:h,disabled:e.isReadonly,labelId:"prom-datasource-label",label:"Prometheus Datasource"})}),(0,r.jsx)(p,{matchers:e.value.matchers??[],isReadonly:e.isReadonly,onChange:b})]})}function x(e){let{onChange:a,value:l,value:{datasource:h}}=e,b=h??d.hu,m=(0,u.useDatasourceSelectValueToSelector)(b,d.eU),{data:v}=(0,u.useDatasourceClient)(m),p=null==v?void 0:v.options.datasourceUrl,j=(0,i.useCallback)(e=>{if((0,u.isVariableDatasource)(e)||(0,d.ZO)(e))return void a((0,n.jM)(l,a=>{a.datasource=!(0,u.isVariableDatasource)(e)&&(0,d.do)(e)?void 0:e}));throw Error("Got unexpected non-Prometheus datasource selector")},[l,a]),f=(0,i.useCallback)(e=>{a((0,n.jM)(l,a=>{a.expr=e.target.textContent??""}))},[a,l]),x=(0,i.useCallback)(e=>{a((0,n.jM)(l,a=>{a.labelName=e.target.value}))},[a,l]);return(0,r.jsxs)(t.A,{spacing:2,children:[(0,r.jsx)(s.A,{margin:"dense",children:(0,r.jsx)(u.DatasourceSelect,{datasourcePluginKind:d.eU,value:b,onChange:j,labelId:"prom-datasource-label",label:"Prometheus Datasource",disabled:e.isReadonly})}),(0,r.jsx)(c.T,{completeConfig:{remote:{url:p}},value:l.expr,datasource:m,onBlur:f,readOnly:e.isReadonly,width:"100%"}),(0,r.jsx)(o.A,{label:"Label Name",required:!0,value:e.value.labelName,slotProps:{input:{readOnly:e.isReadonly}},onChange:x})]})}function g(e,a){let l=new Set;for(let r of e.result){let e=r.metric[a];void 0!==e&&l.add(e)}return Array.from(l.values())}function C(e,a){let l=new Set;for(let r of e.result){let e=r.metric[a];void 0!==e&&l.add(e)}return Array.from(l.values())}let V=e=>e?e.map(e=>({value:e,label:e})):[]}}]);